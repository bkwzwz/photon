diff -ru a/src/mux_h2.c b/src/mux_h2.c
--- a/src/mux_h2.c	2018-09-20 12:09:31.000000000 +0000
+++ b/src/mux_h2.c	2019-04-16 22:11:42.565510380 +0000
@@ -2704,6 +2704,10 @@
 			h2c_error(h2c, H2_ERR_PROTOCOL_ERROR);
 			goto fail;
 		}
+		if (flen < 5) {
+                       h2c_error(h2c, H2_ERR_FRAME_SIZE_ERROR);
+                       goto fail;
+                }
 
 		hdrs += 5; // stream dep = 4, weight = 1
 		flen -= 5;
